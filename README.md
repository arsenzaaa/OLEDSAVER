# OLED SAVER

**OLED SAVER** —  это небольшое фоновое приложение для Windows 11, которое помогает продлить срок службы OLED‑мониторов, уменьшая время показа статичных элементов интерфейса и автоматически затемняя/выключая экран при бездействии (также подходит для тех, кто работает сразу на нескольких мониторах).

## Как скрипт помогает исправить возможное выгорание
- Следит за активностью пользователя и временем простоя системы, чтобы сократить время отображения статичных элементов (панель задач, иконки, фон).
- Определяет активное окно, положение курсора и наличие полноэкранных/видео-приложений, чтобы не мешать просмотру видео и играм, но при этом затемнять «ненужные» области экрана и снижать нагрузку на постоянно светящиеся пиксели.
- Работает с несколькими мониторами сразу, позволяя настраивать поведение для каждого дисплея отдельно и тем самым оптимизировать защиту всех OLED-панелей.
- При длительном простое выключает экран, полностью снимая нагрузку с матрицы.
- Запускается в системном трее и практически не влияет на производительность, оставаясь незаметным даже на слабых ПК.

## Основные функции
- **Черный экран‑оверлей (псевдо‑скринсейвер)**  
  - Для каждого монитора создается полноэкранный черный оверлей, который включается после заданного времени простоя.  
  - Время до включения можно задать отдельно для каждого монитора через окно `OLED Saver Settings` → `Monitor Settings`.

- **Режим фокусировки ("черный фон вокруг активного окна")**  
  - Включаемая опция `Draw Black Overlay`: затемняет весь экран, оставляя "прорезь" только вокруг активного окна.  
  - Присутствуют настройки скругления углов выреза и непрозрачности затемнения (`Overlay Settings` → `Rounded Corners`, `Opacity Settings`).  
  - При уходе курсора из окна затемнение может плавно "выцветать", уменьшая нагрузку на статичные участки.

- **Авто‑скрытие панели задач (присутствует поддержка StartAllBack и прочего софта, который взаимодействует с интерфейсом)**
  - Опция `Hide Taskbar`: прячет панель задач и область "Пуск", чтобы не держать статичный яркий элемент у края экрана.  
  - Панель автоматически появляется, когда курсор подводится к нижнему краю экрана или нажимается клавиша Windows.  
  - Чувствительность к краю и задержка скрытия регулируются (`Taskbar Threshold...`, `Taskbar Timeout...`).

- **Авто‑скрытие значков рабочего стола**  
  - Опция `Hide Desktop Icons`: скрывает и показывает иконки рабочего стола в зависимости от активности и наличия окон.  
  - Таймаут до скрытия можно изменить в `Desktop Icons Timeout Settings`.

- **Автоматическое выключение дисплея**  
  - Опция `Turn Off Display`: по истечении заданного времени простоя отправляет монитору команду выключения.  
  - Таймер задается в `Display Off Timeout Settings`.  
  - При обнаружении воспроизведения видео монитор не выключается.

## Умный учет видео и исключений
- Приложение старается не мешать при просмотре видео или работе с медиаплеерами:  
  - Анализирует активный процесс, заголовок окна и класс окна на предмет видео‑приложений/стриминговых сервисов.  
  - В этом режиме черные оверлеи и авто‑выключение дисплея не срабатывают.
- Есть отдельный пункт меню `Manage Exclusions...`:  
  - Позволяет добавить свои процессы в список исключений, чтобы для них затемнение и выключение экрана не включались (например, редкие плееры или специфические приложения).

## Конфигурация и управление
- Все основные настройки доступны через иконку в трее (`Enabled Features`, `Timeout Settings`, `Overlay Settings`, `Monitor Settings`, `Manage Exclusions...`).
- Конфигурация сохраняется в `settings.json` в `%AppData%\OLEDSaver` и автоматически загружается при старте:
  - Включенность/выключенность функций (панель задач, иконки, оверлеи, выключение дисплея).
  - Таймауты для панели задач, иконок, черного оверлея и выключения экрана.
  - Персональные таймауты для каждого монитора.
  - Список исключенных процессов.
  - Параметры формы и непрозрачности затемнения.
- Также присутствует пункт `Start with Windows`, который включает/отключает программу в автозапуске.
